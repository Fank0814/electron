resources:
- repo: self
steps:
- bash: 'script/bootstrap.py --target_arch=$TARGET_ARCH'

- bash: 'script/build.py -c R'

- bash: 'script/create-dist.py'

- bash: |
   if [ "$UPLOAD_TO_GITHUB" == "true" ]; then
     ELECTRON_S3_BUCKET="$(s3_bucket)" ELECTRON_S3_ACCESS_KEY="$(s3_access_key)" ELECTRON_S3_SECRET_KEY="$(s3_secret_key)" ELECTRON_GITHUB_TOKEN="$(github_token)" script/upload.py
   else
     echo 'Uploading Electron release distribution to s3'
     ELECTRON_S3_BUCKET="$(s3_bucket)" ELECTRON_S3_ACCESS_KEY="$(s3_access_key)" ELECTRON_S3_SECRET_KEY="$(s3_secret_key)" ELECTRON_GITHUB_TOKEN="$(github_token)" script/upload.py --upload_to_s3
   fi

- task: mspremier.PostBuildCleanup.PostBuildCleanup-task.PostBuildCleanup@3
